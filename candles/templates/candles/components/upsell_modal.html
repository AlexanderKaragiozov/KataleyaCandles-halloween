{% load static %}
<!-- Upsell Modal 1: Triggered on Add to Cart (First Item or to unlock tier 1) -->
<div id="upsell-modal-1" class="modal fixed inset-0 z-[60] flex items-center justify-center p-4 hidden">
    <div class="absolute inset-0 bg-black bg-opacity-60 backdrop-blur-sm"></div>
    <div class="modal-content relative bg-white rounded-2xl shadow-2xl max-w-sm w-full mx-auto overflow-hidden">

        <!-- Header Image -->
        <div class="h-32 bg-christmas-red overflow-hidden relative">
            <div class="absolute inset-0 bg-gradient-to-b from-transparent to-black/50"></div>
            <p class="absolute bottom-4 left-4 text-white font-heading text-2xl drop-shadow-md">üéÅ –°–ø–µ—Ü–∏–∞–ª–Ω–æ
                –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ!</p>
        </div>

        <div class="p-6 text-center">
            <p class="text-gray-600 mb-4">–†–∞–∑–≥–ª–µ–¥–∞–π—Ç–µ –¥–Ω–µ—à–Ω–æ—Ç–æ –Ω–∏ —Å–ø–µ—Ü–∏–∞–ª–Ω–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ:</p>

            <!-- Dynamic Recommendation -->
            <div id="upsell-recommendation"
                class="bg-christmas-cream p-4 rounded-lg border border-christmas-gold/30 mb-6">
                <!-- Injected via JS -->
            </div>

            <div class="space-y-3">
                <button id="accept-upsell-1"
                    class="w-full bg-christmas-red text-white font-bold py-3 rounded-lg hover:bg-red-700 transition-colors shadow-md">
                    –î–ê, –î–û–ë–ê–í–ò –° –û–¢–°–¢–™–ü–ö–ê
                </button>
                <button id="decline-upsell-1" class="w-full text-gray-500 hover:text-gray-800 text-sm font-medium">
                    –ù–µ, –±–ª–∞–≥–æ–¥–∞—Ä—è
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Upsell Modal 2: Triggered after accepting Upsell 1 (Unlock max tier) -->
<div id="upsell-modal-2" class="modal fixed inset-0 z-[60] flex items-center justify-center p-4 hidden">
    <div class="absolute inset-0 bg-black bg-opacity-60 backdrop-blur-sm"></div>
    <div class="modal-content relative bg-white rounded-2xl shadow-2xl max-w-md w-full mx-auto overflow-hidden">

        <div class="bg-christmas-gold p-4 text-center">
            <h3 class="font-heading text-2xl text-christmas-dark">üéÑ –ù–∞–ø—Ä–∞–≤–∏ –≥–æ –ö–æ–º–ø–ª–µ–∫—Ç!</h3>
            <p class="text-christmas-dark text-sm font-bold">–í–∑–µ–º–∏ 27% –¢–û–ü –æ—Ç—Å—Ç—ä–ø–∫–∞!</p>
        </div>

        <div class="p-6">
            <p class="text-gray-600 text-center mb-4">–í–µ—á–µ –∏–º–∞—à 2 —Å–≤–µ—â–∏. –î–æ–±–∞–≤–∏ –æ—â–µ 2 –∏ —Ü–µ–Ω–∞—Ç–∞ –ø–∞–¥–∞ –Ω–∞ <br><span
                    class="font-bold text-lg text-christmas-red">~11 –ª–≤/–±—Ä!</span> (–≤–º–µ—Å—Ç–æ 15 –ª–≤)</p>

            <form id="upsell-form-2" class="space-y-3 mb-6">
                <!-- Checkboxes generated by JS -->
            </form>

            <div class="space-y-3">
                <button id="accept-upsell-2"
                    class="w-full bg-christmas-green text-white font-bold py-3 rounded-lg hover:bg-green-800 transition-colors shadow-md">
                    –î–û–ë–ê–í–ò –ò–ó–ë–†–ê–ù–ò–¢–ï
                </button>
                <button id="decline-upsell-2" class="w-full text-gray-500 hover:text-gray-800 text-sm font-medium">
                    –ü—Ä–æ–¥—ä–ª–∂–∏ –∫—ä–º –∫–∞—Å–∞—Ç–∞
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Image Lightbox -->
<div id="image-lightbox" class="modal fixed inset-0 z-[70] flex items-center justify-center p-4 hidden"
    onclick="closeLightbox()">
    <div class="absolute inset-0 bg-black bg-opacity-90 backdrop-blur-md"></div>
    <div class="relative max-w-4xl w-full max-h-screen p-2 flex justify-center">
        <img id="lightbox-image" src="" class="max-w-full max-h-[90vh] rounded-lg shadow-2xl object-contain">
        <button class="absolute top-4 right-4 text-white hover:text-gray-300 text-4xl font-bold"
            onclick="closeLightbox()">&times;</button>
    </div>
</div>
</div>

<!-- Hover Preview (Desktop) -->
<div id="hover-preview" class="fixed z-[80] hidden pointer-events-none drop-shadow-2xl">
    <img id="hover-preview-img" src="" class="w-64 h-64 object-cover rounded-xl border-4 border-white">
</div>