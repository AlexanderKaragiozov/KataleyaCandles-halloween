{% extends 'candles/base_landing.html' %}
{% load static %}

{% block title %}{{ candle.name }}{% endblock %}

{% block content %}
<section class="max-w-6xl mx-auto px-4 py-8 md:py-16">
    <div class="grid md:grid-cols-2 gap-12 items-center">
        <!-- Image Gallery -->
        <div class="relative group">
            <div
                class="absolute -inset-1 bg-gradient-to-r from-christmas-gold to-christmas-red rounded-2xl blur opacity-25 group-hover:opacity-75 transition duration-1000 group-hover:duration-200">
            </div>
            <div class="relative bg-white rounded-2xl overflow-hidden shadow-xl aspect-square">
                <!-- Fallback image logic if static file doesn't exist yet, we use a placeholder -->
                <img src="{% static candle.image %}" alt="{{ candle.name }}"
                    class="w-full h-full object-cover transform hover:scale-105 transition-transform duration-700">

                <!-- Discount Badge -->
                <div
                    class="absolute top-4 right-4 bg-christmas-red text-white px-4 py-2 rounded-full font-bold shadow-lg animate-pulse">
                    -27% –∑–∞ 4+ –±—Ä.
                </div>
            </div>
        </div>

        <!-- Product Details -->
        <div class="text-left space-y-6">
            <h1 class="font-heading text-5xl md:text-6xl text-christmas-red mb-2">{{ candle.name }}</h1>

            <div class="flex items-center space-x-4 mb-6">
                <!-- Price Container -->
                <span class="text-3xl font-bold text-gray-800" id="main-price-display">{{ candle.price }} –ª–≤. <span
                        class="text-gray-500 text-xs font-normal">(~{{ candle.price_eur }} ‚Ç¨)</span></span>
                <span class="text-lg text-gray-500 line-through">35 –ª–≤.</span> <!-- Fake original price for effect -->
                <span
                    class="text-sm bg-green-100 text-green-800 px-2 py-1 rounded-full border border-green-200">–ù–∞–ª–∏—á–Ω–æ</span>
            </div>

            <div class="prose text-gray-600 leading-relaxed">
                <p class="text-lg">{{ candle.description }}</p>
                <p class="font-medium mt-4">
                    <span class="text-christmas-green">‚ú® –ê—Ä–æ–º–∞—Ç–Ω–∏ –Ω–æ—Ç–∫–∏:</span> {{ candle.scent }}
                </p>
            </div>

            <!-- Countdown (Fake urgency) -->
            <div class="bg-christmas-cream border border-christmas-gold/30 rounded-lg p-4 my-6">
                <p class="text-sm text-christmas-red font-bold text-center mb-2">üéÑ –ü—Ä–∏—Å—Ç–∏–≥–∞–Ω–µ –ø—Ä–µ–¥–∏ –ö–æ–ª–µ–¥–∞ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–∞–Ω–æ!
                </p>
                <div class="flex justify-center space-x-4 text-center font-heading">
                    <div>
                        <span class="block text-2xl font-bold text-gray-800" id="days">00</span>
                        <span class="text-xs uppercase text-gray-500">–î–Ω–∏</span>
                    </div>
                    <div><span class="block text-2xl font-bold text-gray-800">:</span></div>
                    <div>
                        <span class="block text-2xl font-bold text-gray-800" id="hours">00</span>
                        <span class="text-xs uppercase text-gray-500">–ß–∞—Å–∞</span>
                    </div>
                    <div><span class="block text-2xl font-bold text-gray-800">:</span></div>
                    <div>
                        <span class="block text-2xl font-bold text-gray-800" id="minutes">00</span>
                        <span class="text-xs uppercase text-gray-500">–ú–∏–Ω</span>
                    </div>
                </div>
            </div>

            <!-- Actions -->
            <div class="space-y-4">
                <button onclick="addToCart('{{ candle.slug }}')"
                    class="w-full bg-christmas-green hover:bg-green-800 text-white font-bold py-4 px-8 rounded-full shadow-lg transform active:scale-95 transition-all flex items-center justify-center space-x-2 text-xl">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                        stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z" />
                    </svg>
                    <span>–î–æ–±–∞–≤–∏ –≤ –∫–æ–ª–∏—á–∫–∞—Ç–∞</span>
                </button>
                <p class="text-center text-xs text-gray-500">üöö –ë–µ–∑–ø–ª–∞—Ç–Ω–∞ –¥–æ—Å—Ç–∞–≤–∫–∞ ‚Ä¢ üí∞ –ü–ª–∞—â–∞–Ω–µ –ø—Ä–∏ –ø–æ–ª—É—á–∞–≤–∞–Ω–µ</p>
            </div>

            <!-- Benefits -->
            <div class="grid grid-cols-2 gap-4 mt-8">
                <div class="flex items-center space-x-2 text-sm text-gray-600">
                    <span class="text-christmas-gold">‚òÖ</span> <span>–†—ä—á–Ω–∞ –∏–∑—Ä–∞–±–æ—Ç–∫–∞</span>
                </div>
                <div class="flex items-center space-x-2 text-sm text-gray-600">
                    <span class="text-christmas-gold">‚òÖ</span> <span>–ù–∞—Ç—É—Ä–∞–ª–µ–Ω –≤–æ—Å—ä–∫</span>
                </div>
                <div class="flex items-center space-x-2 text-sm text-gray-600">
                    <span class="text-christmas-gold">‚òÖ</span> <span>–î—ä–ª–≥–æ –≥–æ—Ä–µ–Ω–µ</span>
                </div>
                <div class="flex items-center space-x-2 text-sm text-gray-600">
                    <span class="text-christmas-gold">‚òÖ</span> <span>–°–∏–ª–Ω–∞ –∞—Ä–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Collection Section -->
    <div class="mt-20 max-w-6xl mx-auto">
        <h2 class="font-heading text-3xl text-center text-christmas-red mb-8">–†–∞–∑–≥–ª–µ–¥–∞–π—Ç–µ —Ü—è–ª–∞—Ç–∞ –∫–æ–ª–µ–¥–Ω–∞ –∫–æ–ª–µ–∫—Ü–∏—è</h2>
        <div class="grid grid-cols-2 md:grid-cols-4 gap-6">
            {% for c in all_candles %}
            {% if not c.is_upsell %}
            <a href="{% url 'product_detail' c.slug %}" class="group block text-center">
                <div
                    class="relative rounded-xl overflow-hidden shadow-md mb-3 aspect-square border-2 border-transparent group-hover:border-christmas-gold transition-all duration-300 transform group-hover:-translate-y-1">
                    <img src="{% static c.image %}" alt="{{ c.name }}" class="w-full h-full object-cover">
                    <div class="absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-10 transition-opacity">
                    </div>
                </div>
                <h3 class="font-bold text-gray-800 group-hover:text-christmas-red transition-colors">{{ c.name }}</h3>
                <p class="text-sm text-gray-500 collection-price">{{ c.price }} –ª–≤. <span
                        class="text-gray-500 text-xs font-normal">(~{{ c.price_eur }} ‚Ç¨)</span></p>
            </a>
            {% endif %}
            {% endfor %}
        </div>
    </div>

    <!-- More Info / FAQ Section -->
    <div class="mt-20 max-w-3xl mx-auto">
        <h2 class="font-heading text-3xl text-center text-christmas-red mb-8">–ß–µ—Å—Ç–æ –∑–∞–¥–∞–≤–∞–Ω–∏ –≤—ä–ø—Ä–æ—Å–∏</h2>

        <div class="space-y-4">
            <details class="group bg-white rounded-lg shadow-sm p-4 cursor-pointer">
                <summary class="font-bold text-gray-800 flex justify-between items-center">
                    –ö–æ–ª–∫–æ –≤—Ä–µ–º–µ –≥–æ—Ä–∏ —Å–≤–µ—â—Ç–∞?
                    <span class="transform group-open:rotate-180 transition-transform">‚ñº</span>
                </summary>
                <p class="mt-2 text-gray-600">–ù–∞—à–∏—Ç–µ —Å–≤–µ—â–∏ –≥–æ—Ä—è—Ç –º–µ–∂–¥—É 40 –∏ 50 —á–∞—Å–∞, –∏–∑–ø—ä–ª–≤–∞–π–∫–∏ –¥–æ–º–∞ –≤–∏ —Å –ø—Ä–µ–∫—Ä–∞—Å–µ–Ω
                    –∞—Ä–æ–º–∞—Ç.</p>
            </details>

            <details class="group bg-white rounded-lg shadow-sm p-4 cursor-pointer">
                <summary class="font-bold text-gray-800 flex justify-between items-center">
                    –û—Ç –∫–∞–∫—ä–≤ –≤–æ—Å—ä–∫ —Å–∞ –Ω–∞–ø—Ä–∞–≤–µ–Ω–∏?
                    <span class="transform group-open:rotate-180 transition-transform">‚ñº</span>
                </summary>
                <p class="mt-2 text-gray-600">–ò–∑–ø–æ–ª–∑–≤–∞–º–µ 100% –Ω–∞—Ç—É—Ä–∞–ª–µ–Ω —Å–æ–µ–≤ –≤–æ—Å—ä–∫, –∫–æ–π—Ç–æ –µ –±–µ–∑–≤—Ä–µ–¥–µ–Ω –∏ –µ–∫–æ–ª–æ–≥–∏—á–µ–Ω.</p>
            </details>

            <details class="group bg-white rounded-lg shadow-sm p-4 cursor-pointer">
                <summary class="font-bold text-gray-800 flex justify-between items-center">
                    –ò–º–∞ –ª–∏ –æ—Ç—Å—Ç—ä–ø–∫–∞ –∑–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞?
                    <span class="transform group-open:rotate-180 transition-transform">‚ñº</span>
                </summary>
                <p class="mt-2 text-gray-600">–î–∞! –í–∑–µ–º–µ—Ç–µ 13% –æ—Ç—Å—Ç—ä–ø–∫–∞ –∑–∞ 2 —Å–≤–µ—â–∏, 20% –∑–∞ 3 —Å–≤–µ—â–∏ –∏ 27% –∑–∞ 4 –∏–ª–∏ –ø–æ–≤–µ—á–µ.
                </p>
            </details>
        </div>
    </div>
</section>

<script>
    // Countdown Timer (Hardcoded to Dec 25th of current year)
    const currentYear = new Date().getFullYear();
    const christmas = new Date(`December 25, ${currentYear} 00:00:00`).getTime();

    const x = setInterval(function () {
        const now = new Date().getTime();
        const distance = christmas - now;

        const days = Math.floor(distance / (1000 * 60 * 60 * 24));
        const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));

        document.getElementById("days").innerHTML = String(days).padStart(2, '0');
        document.getElementById("hours").innerHTML = String(hours).padStart(2, '0');
        document.getElementById("minutes").innerHTML = String(minutes).padStart(2, '0');

        if (distance < 0) {
            clearInterval(x);
            // Handle expired logic
        }
    }, 1000);
</script>
{% endblock %}